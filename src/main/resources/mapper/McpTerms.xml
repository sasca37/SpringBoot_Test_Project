<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">


<mapper namespace="com.mainline.magic.scheduler.dao.McpTermsMergeLiDao">

	<select id="boardList" resultType="McpTerms">
		SELECT
		       *
		FROM (
			  SELECT ROW_NUMBER() OVER (ORDER BY TO_NUMBER(STATUS)) NUM
			  ,MERGE_ID
			  ,CODE
			  ,STATUS
			  ,CREATOR
			  ,TO_CHAR(CREATED,'YYYY-MM-DD') AS CREATED
			  ,UPDATOR
			  ,UPDATED
			  ,PATH
			  ,TO_CHAR(CONTRACT_DATE,'YYYY-MM-DD') AS CONTRACT_DATE
			  ,PRODUCT_CODE
			  ,REGISTRATION_NUM
			  FROM MCP_TERMS_MERGE_LI
			 <!-- <![CDATA[WHERE TRUNC(SYSDATE) - TO_CHAR(CREATED, 'YYYYMMDD') > 1]]>-->
			  WHERE 1=1
				  <if test="status != null and !status.equals('null')">
					    AND STATUS = #{status}
				  </if>
				  <if test="registration_num != null and !registration_num.equals('null')">
				  	    AND REGISTRATION_NUM = #{registration_num}
				  </if>
				  <if test="contract_date != null and !contract_date.equals('null')">
						AND CONTRACT_DATE = #{contract_date}
				  </if>
				  <if test="created_start != null and !created_start.equals('null')">
						AND CREATED <![CDATA[>=]]> #{created_start}
				  </if>
				  <if test="created_end != null and !created_end.equals('null')">
						AND CREATED <![CDATA[<=]]> #{created_end}
				  </if>
						<![CDATA[
						AND TO_CHAR(ADD_MONTHS(SYSDATE,-1),'YYYY-MM-DD') <= CREATED
						AND CREATED <= TO_CHAR(ADD_MONTHS(SYSDATE,+1),'YYYY-MM-DD')
						]]>
			ORDER BY NUM
			 )
		WHERE
		      NUM
		BETWEEN
		      #{pageStart}+1 AND #{perPageNum}+#{pageStart}

	</select>

	<select id="boardListCnt"  resultType="int">

		SELECT
		        COUNT(*)
		FROM
		        MCP_TERMS_MERGE_LI
		WHERE 1=1
				<if test="status != null and !status.equals('null')">
					AND STATUS = #{status}
				</if>
				<if test="registration_num != null and !registration_num.equals('null')">
					AND REGISTRATION_NUM = #{registration_num}
				</if>
				<if test="contract_date != null and !contract_date.equals('null')">
					AND CONTRACT_DATE = #{contract_date}
				</if>
				<if test="created_start != null and !created_start.equals('null')">
					AND CREATED <![CDATA[>=]]> #{created_start}
				</if>
				<if test="created_end != null and !created_end.equals('null')">
					AND CREATED <![CDATA[<=]]> #{created_end}
				</if>
					<![CDATA[
					AND TO_CHAR(ADD_MONTHS(SYSDATE,-1),'YYYY-MM-DD') <= CREATED
					AND CREATED <= TO_CHAR(ADD_MONTHS(SYSDATE,+1),'YYYY-MM-DD')
					]]>
		/*select to_char(add_months(sysdate,-1),'yyyy-mm-dd') as 한달전 from mcp_terms_merge_li;*/

	</select>

	<!--<sql id="search">
		<if test="status != null">
			<if test="status == 't'.toString()">AND TITLE LIKE '%' || #{status} || '%'</if>
			<if test="status == 'c'.toString()">AND CONTENT LIKE '%' || #{status} || '%'</if>
			<if test="status == 'w'.toString()">AND WRITER LIKE '%' || #{status} || '%'</if>
			<if test="status == 'tc'.toString()">AND (TITLE LIKE '%' || #{status} || '%') or (CONTENT LIKE '%' || #{keyword} || '%')</if>
		</if>
	</sql>-->
</mapper>